<!--_meta 作为公共模版分离出去-->
<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta name="renderer" content="webkit|ie-comp|ie-stand">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <link rel="Bookmark" href="/favicon.ico" >
  <link rel="Shortcut Icon" href="/favicon.ico" />
  <!--[if lt IE 9]>
  <script type="text/javascript" src="lib/html5shiv.js"></script>
  <script type="text/javascript" src="lib/respond.min.js"></script>
  <![endif]-->
  <link rel="stylesheet" type="text/css" href="static/h-ui/css/H-ui.min.css" />
  <link rel="stylesheet" type="text/css" href="static/h-ui.admin/css/H-ui.admin.css" />
  <link rel="stylesheet" type="text/css" href="lib/Hui-iconfont/1.0.8/iconfont.css" />
  <link rel="stylesheet" type="text/css" href="static/h-ui.admin/skin/default/skin.css" id="skin" />
  <link rel="stylesheet" type="text/css" href="static/h-ui.admin/css/style.css" />
  <!--[if IE 6]>
  <script type="text/javascript" src="lib/DD_belatedPNG_0.0.8a-min.js" ></script>
  <script>DD_belatedPNG.fix('*');</script>
  <![endif]-->
  <!--/meta 作为公共模版分离出去-->

  <title>proHttp</title>
  <meta name="keywords" content="">
  <meta name="description" content="">
  <style>
    .proImg{
      margin-top: 50px;
    }
    .proImg ul{
      overflow: hidden;
    }
    .proImg li{
      float: left;
      margin: 1% 2%;
      width: 15%;
      border:3px solid #71c39a;
    }
    .proImg li img{
      width: 100%;
    }
    .col-sm-offset-3 {
      margin-left: 10%;
    }
    .col-sm-3{
      width: 10%;
    }
    .loadingS{
      text-align: center;
      margin-top: 8%;
      display: none;
    }
  </style>
</head>
<body>
<article class="page-container" id="app">
  <form class="form form-horizontal" id="form-member-add">
    <div class="row cl">
      <label class="form-label col-xs-4 col-sm-3">生产厂家：</label>
      <div class="formControls col-xs-8 col-sm-9"> <span class="select-box">
				<select class="select vender" size="1" name="厂家">
					<option v-bind:value="goods.Name" >{{goods.Name}}</option>
				</select>
        <!--<input type="text" class="input-text" value="厦门" placeholder="" id="" name="厂家">-->
				</span> </div>
    </div>
    <div class="row cl">
      <label class="form-label col-xs-4 col-sm-3">产品ID：</label>
      <div class="formControls col-xs-8 col-sm-9"> <span class="select-box">
				<select class="select pors" size="1" name="产品">
        <option v-bind:value="pro" v-for="pro in goods.data">{{pro.proID}} {{pro.proName}}</option>
        </select>
        <!--<input type="text" class="input-text proID" value="100" placeholder="" id="" name="产品ID">-->
				</span> </div>
    </div>
    <div class="row cl">
      <label class="form-label col-xs-4 col-sm-3"><span class="c-red">*</span>保存目录：</label>
      <div class="formControls col-xs-8 col-sm-9">
        <input type="text" class="input-text proMl" value="Dooooooo" placeholder="" id="" name="保存目录">
      </div>
    </div>
    <div class="row cl">
      <label class="form-label col-xs-4 col-sm-3"><span class="c-red">*</span>URL地址：</label>
      <div class="formControls col-xs-8 col-sm-9">
        <input type="text" class="input-text" value="https://images.wallpaperscraft.com/image/coast_sea_turbidite_layers_126232_1280x720.jpg 110 0" placeholder="" id="" name="任务">
      </div>
    </div>
    <!--<div class="row cl">-->
    <!--<label class="form-label col-xs-4 col-sm-3">所在城市：</label>-->
    <!--<div class="formControls col-xs-8 col-sm-9"> <span class="select-box">-->
    <!--<select class="select" size="1" name="city">-->
    <!--<option value="" selected>请选择城市</option>-->
    <!--<option value="1">北京</option>-->
    <!--<option value="2">上海</option>-->
    <!--<option value="3">广州</option>-->
    <!--</select>-->
    <!--</span> </div>-->
    <!--</div>-->

    <!--v-on:click="getcode"-->
    <div class="row cl">
      <div class="col-xs-8 col-sm-9 col-xs-offset-4 col-sm-offset-3">
        <input class="btn btn-primary radius" type="button" value="提交" v-on:click="getcode()">
      </div>
    </div>
  </form>
  <!--<div class="tables">-->
    <!--<table>-->
      <!--<thead>-->
        <!--<tr>-->
          <!--<th>序号</th>-->
          <!--<th>供货商</th>-->
          <!--<th>产品ID</th>-->
        <!--</tr>-->
      <!--</thead>-->
    <!--</table>-->
  <!--</div>-->
  <div class="loadingS">
    <img src="temp/5-121204193R0-50.gif">
  </div>
  <div class="proImg">
    <ul >
      <li v-for="pro in goodImg">
        <img v-bind:src="['http://tp1.015144.com'+pro]">
      </li>
    </ul>
  </div>
</article>

<!--_footer 作为公共模版分离出去-->
<script type="text/javascript" src="lib/jquery/1.9.1/jquery.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/vue@2.5.17/dist/vue.js"></script>
<script src="https://cdn.bootcss.com/axios/0.18.0/axios.min.js"></script>
<script src="http://cdn.bootcss.com/vue-resource/1.1.0/vue-resource.js"></script>
<script src="https://unpkg.com/vue-lazyload/vue-lazyload.js"></script>

<script type="text/javascript" src="lib/layer/2.4/layer.js"></script>
<script type="text/javascript" src="static/h-ui/js/H-ui.min.js"></script>
<script type="text/javascript" src="static/h-ui.admin/js/H-ui.admin.js"></script> <!--/_footer 作为公共模版分离出去-->

<!--请在下方写此页面业务相关的脚本-->
<script type="text/javascript" src="lib/My97DatePicker/4.8/WdatePicker.js"></script>
<script type="text/javascript" src="lib/jquery.validation/1.14.0/jquery.validate.js"></script>
<script type="text/javascript" src="lib/jquery.validation/1.14.0/validate-methods.js"></script>
<script type="text/javascript" src="lib/jquery.validation/1.14.0/messages_zh.js"></script>

<script type="text/javascript">
  var app = new Vue({
    el:'#app',
    data:{
      goods:[],
      goodXm:[],
      goodImg:[]
    },
    methods:{
      getGoods(){
        // var _self = this;
        // $.get('../interface/xmPro.json', function(obj){
        //   _self.goods = obj.data;
        //   console.log( _self.goods);
        // })
        // console.log(this.goods);
        this.$http.get('../interface/setTask.json').then((res) => {
          this.goods = res.data
          console.log(JSON.stringify(this.goods))
          console.log(this.goods)
        }, (err) => {
          console.log(err)
        })
      },
      getXm(){
        // var _self = this;
        // $.get('http://zhukong.0f8.net:12345/showf', function(obj){
        //   _self.goodXm = obj.data;
        //   console.log( _self.goodXm);
        // })
        // console.log(this.goodXm);
        this.$http.get('../interface/xmPro.json').then((res) => {
          this.goodXm = res.data
          console.log(this.goodXm)
        }, (err) => {
          console.log(err)
        })
      },

      getcode(){
        //创建数据
        this.$http.post("http://tp1.015144.com/creatMisson",$('#form-member-add').serialize(),{
        //this.$http.post("http://amazon.2012.net/creatMisson",$('#form-member-add').serialize(),{
          headers:{
            'Accept':'*/*',
            'Content-Type':"application/x-www-form-urlencoded",
            'Access-Control-Allow-Origin': '*'
          }
        }).then(function (res) {
            console.log("创建成功，请在监控页面耐心等待。");
            alert("创建成功，请在监控页面耐心等待。");
            $(".loadingS").show();
              //获取
            let thit = this;
          setTimeout(function () {
            $(".loadingS").hide();
            thit.$http.get('http://tp1.015144.com/viewImage/'+$('.proMl').val()+'/'+$('.proID').val()+'/?ImageName=coast_sea_turbidite_layers_126232_1280x720.jpg&onlyList=1').then((res) => {
              thit.goodImg = res.data
              if(thit.goodImg == ""){
                alert("获取失败");
              }
              console.log(JSON.stringify(thit.goodImg))
              console.log(thit.goodImg)
            }, (err) => {
              console.log(err)
            })
          },10000)


          })
          .catch(function () {
            console.log("创建失败，请检查提交参数。")
            alert("创建失败，请检查提交参数。")
          });
      }
    },
    created(){
      this.getGoods(),
      this.getXm()
    },
    watch:{
      goods(val){
        this.goods = val
      },
      goodXm(val){
        this.goodXm = val
      },
      // goodImg(val){
      //   this.goodImg = val
      // }
    }
  })

  // $(".radius").click(function(){
  //   $.ajax({
  //     url:"http://amazon.2012.net/creatMisson",
  //     method:"post",
  //     data:$('#form-member-add').serialize(),
  //     dataType:"json",
  //     headers: {"X-Requested-With": "XMLHttpRequest"},
  //     success:function(response){
  //       console.log(response,"success");
  //     },
  //     error:function(error){
  //       console.error(error,"error");
  //     }
  //   })
  // })

  $(function(){
    $('.skin-minimal input').iCheck({
      checkboxClass: 'icheckbox-blue',
      radioClass: 'iradio-blue',
      increaseArea: '20%'
    });

    $("#form-member-add").validate({
      rules:{
        username:{
          required:true,
          minlength:2,
          maxlength:16
        },
        sex:{
          required:true,
        },
        mobile:{
          required:true,
          isMobile:true,
        },
        email:{
          required:true,
          email:true,
        },
        uploadfile:{
          required:true,
        },

      },
      onkeyup:false,
      focusCleanup:true,
      success:"valid",
      submitHandler:function(form){
        //$(form).ajaxSubmit();
        var index = parent.layer.getFrameIndex(window.name);
        //parent.$('.btn-refresh').click();
        parent.layer.close(index);
      }
    });
  });
</script>
<!--/请在上方写此页面业务相关的脚本-->
</body>
</html>
